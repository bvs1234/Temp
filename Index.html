<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f0f8ff;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    h1, h2 {
      color: #4a90e2;
    }
    #fileInput {
      margin: 10px 0;
      padding: 10px;
      border: 2px solid #4a90e2;
      border-radius: 5px;
      font-size: 16px;
    }
    button {
      background-color: #4a90e2;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 15px 30px; /* Increased padding for bigger buttons */
      cursor: pointer;
      font-size: 18px; /* Increased font size for better readability */
      transition: background-color 0.3s;
      margin-top: 10px; /* Added margin for better spacing */
    }
    button:hover {
      background-color: #357ab7;
    }
    #fileList {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #4a90e2;
      border-radius: 5px;
      background-color: #fff;
    }
    #fileList div {
      margin: 5px 0;
    }
    a {
      text-decoration: none;
      color: #4a90e2;
    }
    a:hover {
      text-decoration: underline;
      color: #357ab7;
    }
    .delete-button {
      background-color: #e74c3c;
      margin-left: 10px;
    }
    .delete-button:hover {
      background-color: #c0392b;
    }
  </style>
  <script>
    function uploadFile() {
      const fileInput = document.getElementById('fileInput');
      const file = fileInput.files[0];

      if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          const fileData = {
            name: file.name,
            mimeType: file.type,
            bytes: e.target.result.split(',')[1]
          };
          google.script.run.withSuccessHandler(() => {
            alert('File uploaded successfully!');
            listFiles();
          }).uploadFile(fileData);
        };
        reader.readAsDataURL(file);
      }
    }

    function listFiles() {
      google.script.run.withSuccessHandler(renderFileList).listFiles();
    }

    function renderFileList(files) {
      const fileListDiv = document.getElementById('fileList');
      fileListDiv.innerHTML = '';

      if (files.length === 0) {
        fileListDiv.innerHTML = '<div>No files found.</div>'; // Show message if no files
        return;
      }

      files.forEach(file => {
        const fileElement = document.createElement('div');
        fileElement.innerHTML = `
          <a href="${file.url}" target="_blank">${file.name}</a>
          <button class="delete-button" onclick="deleteFile('${file.id}')">Delete</button>
        `;
        fileListDiv.appendChild(fileElement);
      });
    }

    function deleteFile(fileId) {
      if (confirm('Are you sure you want to delete this file?')) {
        google.script.run.withSuccessHandler(() => {
          alert('File deleted successfully!');
          listFiles();
        }).deleteFile(fileId);
      }
    }

    window.onload = listFiles;
  </script>
</head>
<body>
  <h1>Upload File to Google Drive</h1>
  <input type="file" id="fileInput" />
  <button onclick="uploadFile()">Upload</button>
  
  <h2>Files in Drive</h2>
  <div id="fileList"></div>
</body>
</html>
